

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Laptop assignment 2 &#8212; Jupyter Book Template</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/Calc prog 2 Kiefer Plender';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
    <p class="title logo__title">Jupyter Book Template</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="home.html">
                    Jupyter Book Tutorial
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebook.html">Example Notebook</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/yenchiah/jupyter-book-template/blob/main/docs/docs/Calc prog 2 Kiefer Plender.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/yenchiah/jupyter-book-template" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/yenchiah/jupyter-book-template/issues/new?title=Issue%20on%20page%20%2Fdocs/Calc prog 2 Kiefer Plender.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/Calc prog 2 Kiefer Plender.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Laptop assignment 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-of-newton-raphson-method">Implementation of Newton-Raphson method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-1-2-5-pt">TODO 1 (2.5 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closure-of-polynomial-functions">Closure of Polynomial Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivate-function">Derivate function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-2-1-pt">TODO 2 (1 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-examples">Specific examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-3-0-5-pt">TODO 3 (0.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-4-0-25-pt">TODO 4 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-5-0-25-pt">TODO 5 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-6-0-25-pt">TODO 6 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-7-0-25-pt">TODO 7 (0.25 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxed-newton-method">Relaxed Newton method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-8-1-pt">TODO 8 (1 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-histograms-for-the-newton-method">Plotting histograms for the Newton method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-9-2-5-pt">TODO 9 (2.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-hints-for-the-function">Some hints for the function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-histograms-while-differentiating-each-root">Plotting histograms while differentiating each root</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-10-1-pt">TODO 10 (1 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-11-2-pt">TODO 11 (2 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-method-in-2-dimensions">Newton method in 2 dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-12-3-pts">TODO 12 (3 pts)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-finding-the-angle-for-a-projectile-bonus-0-5-pt">Application: finding the angle for a projectile (bonus 0.5 pt)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="laptop-assignment-2">
<h1>Laptop assignment 2<a class="headerlink" href="#laptop-assignment-2" title="Permalink to this heading">#</a></h1>
<section id="implementation-of-newton-raphson-method">
<h2>Implementation of Newton-Raphson method<a class="headerlink" href="#implementation-of-newton-raphson-method" title="Permalink to this heading">#</a></h2>
<p>The Newton-Raphson method is a method to find successively better approximations of the roots of a function <span class="math notranslate nohighlight">\(f\)</span>, given you know its derivative <span class="math notranslate nohighlight">\(f'\)</span>. Given a starting approximation <span class="math notranslate nohighlight">\(x_0\)</span>, we iteratively compute approximations <span class="math notranslate nohighlight">\(x_0, \dots, x_k\)</span> using the following rule: If <span class="math notranslate nohighlight">\(x_i\)</span> is the approximation of the root at the <span class="math notranslate nohighlight">\(i\)</span>-th iteration, then <span class="math notranslate nohighlight">\(x_{i+1}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i - \frac{f(x_i)}{f'(x_i)}.
\]</div>
<section id="todo-1-2-5-pt">
<h3>TODO 1 (2.5 pt)<a class="headerlink" href="#todo-1-2-5-pt" title="Permalink to this heading">#</a></h3>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">newton_method(f,</span> <span class="pre">f_prime,</span> <span class="pre">x_0,</span> <span class="pre">tol,</span> <span class="pre">max_it)</span></code> that computes a root of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> using the Newton-Raphson method with starting point <code class="docutils literal notranslate"><span class="pre">x_0</span></code>, tolerance <code class="docutils literal notranslate"><span class="pre">tol</span></code> and maximum number of iterations <code class="docutils literal notranslate"><span class="pre">max_it</span></code>. The input <code class="docutils literal notranslate"><span class="pre">f_prime</span></code> is the derivative of <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>Note that both <code class="docutils literal notranslate"><span class="pre">f</span></code> and <code class="docutils literal notranslate"><span class="pre">f_prime</span></code> are functions passed as arguments to the function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code>, which means that they can be used inside that function as regular functions, e.g. <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> would apply the function <code class="docutils literal notranslate"><span class="pre">f</span></code> to the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> should output</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_k\)</span>, the <span class="math notranslate nohighlight">\(k^{th}\)</span> approximation of the root, either because <span class="math notranslate nohighlight">\(|x_k - x_{k+1}| &lt;\)</span> <code class="docutils literal notranslate"><span class="pre">tol</span></code> or <span class="math notranslate nohighlight">\(k =\)</span> <code class="docutils literal notranslate"><span class="pre">max_it</span></code></p></li>
<li><p>the number <span class="math notranslate nohighlight">\(k\)</span> of iterations that have been perfomed to reach that approximation</p></li>
</ul>
<p>When implementing the method and computing</p>
<div class="math notranslate nohighlight">
\[
x_i - \frac{f(x_i)}{f'(x_i)}.
\]</div>
<p>Do not forget to take into account the case where <span class="math notranslate nohighlight">\(f'(x_i) =0\)</span>. In that case, either (a) <span class="math notranslate nohighlight">\(f(x_i) =0\)</span> and we found the root (so the method converges and the algorithm can stop) or (b) <span class="math notranslate nohighlight">\(f(x_i) \neq 0\)</span> and the method diverges. In case (b), the approximation of the root should be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> and <span class="math notranslate nohighlight">\(k\)</span> (the number of iterations) should be set to <span class="math notranslate nohighlight">\(0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">x_k</span> <span class="o">=</span> <span class="n">x_0</span>

    <span class="k">if</span> <span class="n">f_prime</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_k</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">max_it</span><span class="p">:</span>
        <span class="n">f_prime_k</span> <span class="o">=</span> <span class="n">f_prime</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">f_prime_k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">x_k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span>

        <span class="n">x_k_plus_1</span> <span class="o">=</span> <span class="n">x_k</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span> <span class="o">/</span> <span class="n">f_prime_k</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_k_plus_1</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x_k</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span>

        <span class="n">x_k</span> <span class="o">=</span> <span class="n">x_k_plus_1</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">x_k</span><span class="p">,</span> <span class="n">k</span>

    
<span class="k">def</span> <span class="nf">func_0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> 

<span class="k">def</span> <span class="nf">func_0_der</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span>

<span class="k">def</span> <span class="nf">func_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
    
<span class="k">def</span> <span class="nf">func_1_der</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
    
<span class="k">def</span> <span class="nf">func_2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
    
<span class="k">def</span> <span class="nf">func_2_der</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>You can run the four cells below to check your function. In particular, they will test that the output of <code class="docutils literal notranslate"><span class="pre">newton_method(func_0,</span> <span class="pre">func_0_der,</span> <span class="pre">1.2,</span> <span class="pre">0.1,</span> <span class="pre">50)</span></code> is <code class="docutils literal notranslate"><span class="pre">(0.1923747694931711,</span> <span class="pre">4)</span></code> and the output of <code class="docutils literal notranslate"><span class="pre">newton_method(func_0,</span> <span class="pre">func_0_der,</span> <span class="pre">0.4,</span> <span class="pre">0.1,</span> <span class="pre">10)</span></code> is <code class="docutils literal notranslate"><span class="pre">(0.10891494509584959,</span> <span class="pre">3)</span></code>. If the tests fail, check these cases yourself and consider priting the approximation and the number of iteration at each step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_func_close</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">arg_list</span><span class="p">,</span> <span class="n">ret_list</span><span class="p">,</span> <span class="n">index_list</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">ret</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">arg_list</span><span class="p">,</span> <span class="n">ret_list</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s2">&quot;Basic test failed&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_func_close</span><span class="p">(</span><span class="n">newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">func_0</span><span class="p">,</span> <span class="n">func_0_der</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],[</span><span class="n">func_0</span><span class="p">,</span> <span class="n">func_0_der</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">func_1</span><span class="p">,</span> <span class="n">func_1_der</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="p">[(</span><span class="mf">0.10891494509584959</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1923747694931711</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function seems to output the right approximation (i.e. the first component of the output is correct)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to output the right approximation (i.e. the first component of the output is correct)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_func_close</span><span class="p">(</span><span class="n">newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">func_0</span><span class="p">,</span> <span class="n">func_0_der</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],[</span><span class="n">func_0</span><span class="p">,</span> <span class="n">func_0_der</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="n">func_1</span><span class="p">,</span> <span class="n">func_1_der</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="p">[(</span><span class="mf">0.10891494509584959</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.1923747694931711</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function seems to output the right number of iterations (i.e. the second component of the output is correct)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to output the right number of iterations (i.e. the second component of the output is correct)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_func_close</span><span class="p">(</span><span class="n">newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">func_2</span><span class="p">,</span> <span class="n">func_2_der</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function seems to handle correclty the case when the method diverges&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to handle correclty the case when the method diverges
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="closure-of-polynomial-functions">
<h2>Closure of Polynomial Functions<a class="headerlink" href="#closure-of-polynomial-functions" title="Permalink to this heading">#</a></h2>
<p>Given some list of polynomial coefficients, we would like to have a general way to obtain a polynomial function associated with that list of coefficients. The first thing we may want to try is to define a function <code class="docutils literal notranslate"><span class="pre">polynome(list_coeff,</span> <span class="pre">x)</span></code> which returns the image of <code class="docutils literal notranslate"><span class="pre">x</span></code> for the polynomial associated with <code class="docutils literal notranslate"><span class="pre">list_coeff</span></code>. The problem with this is that the first argument of <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> should be a one-argument function <code class="docutils literal notranslate"><span class="pre">f</span></code>, meaning we cannot use our current definition of <code class="docutils literal notranslate"><span class="pre">polynome</span></code>, as it has 2 arguments, the parameter <code class="docutils literal notranslate"><span class="pre">list_coeff</span></code> and the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>So, here we use a nice Python trick called <em>closures</em>. It is a way use functions to define functions, where the inner function (the closure) will still be able to use variable inside the scope of the outer function, meaning these outer variables are included as kind of <em>global variables</em> closed specifically in the definition of the inner function.</p>
<p>Below is the trick in action. The function <code class="docutils literal notranslate"><span class="pre">pol_closure</span></code> computes the result of a polynomial for some value of <span class="math notranslate nohighlight">\(x\)</span>, but also depends on <code class="docutils literal notranslate"><span class="pre">list_coeff</span></code>, which defines what the actual polynomial is. The <code class="docutils literal notranslate"><span class="pre">list_coeff</span></code> is a list of pairs, where the first element is the coefficent and the second element is the corresponding power. So, for example the polynomial</p>
<div class="math notranslate nohighlight">
\[3x^5 + 7x^2 + 4x + 9\]</div>
<p>would be encoded in the list as</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[(3, 5), (7, 2), (4, 1), (9, 0)]
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">polynome</span></code> returns the newly defined function as a result, so you can call this function with a list of coefficients as an argument to create the <code class="docutils literal notranslate"><span class="pre">pol_closure</span></code> function that only takes <code class="docutils literal notranslate"><span class="pre">x</span></code> as an argument. Verify for yourself that the function <code class="docutils literal notranslate"><span class="pre">pol_closure</span></code> does indeed compute the value of the polynomial defined by <code class="docutils literal notranslate"><span class="pre">list_coeff</span></code>.</p>
<p>Here, as a simple example, we use it to create the same function <span class="math notranslate nohighlight">\(x^3 + 3x^2\)</span> as before, but now as a closure. We define a separate list of coefficients for the derivative too and use both closures to make find the root with <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> as before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">polynome</span><span class="p">(</span><span class="n">list_coeff</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">pol_closure</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">list_coeff</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">+=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
        <span class="k">return</span> <span class="n">image</span>
    
    <span class="k">return</span> <span class="n">pol_closure</span>


<span class="n">func_0_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">func_0_der_list</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">func_0_closure</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">func_0_list</span><span class="p">)</span>
<span class="n">func_0_der_closure</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">func_0_der_list</span><span class="p">)</span>

<span class="n">newton_method</span><span class="p">(</span><span class="n">func_0_closure</span><span class="p">,</span> <span class="n">func_0_der_closure</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.10891494509584959, 3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="derivate-function">
<h2>Derivate function<a class="headerlink" href="#derivate-function" title="Permalink to this heading">#</a></h2>
<p>Now, we just defined a separate list for the derivate, but given a list of a polynomial, it should be possible to just compute what the resulting derivative list is. In fact, that might be the algorithm you’re applying yourself when trying to solve this problem. If we write it out in code once, then we can easily take the derivative of any polynomial function we write in list form.</p>
<section id="todo-2-1-pt">
<h3>TODO 2 (1 pt)<a class="headerlink" href="#todo-2-1-pt" title="Permalink to this heading">#</a></h3>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">polynomial_der</span></code> that takes a list of coefficients as its only argument and returns a new list of coefficients which corresponds to the derivative of that polynomial. E.g. when you give the function <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">3),</span> <span class="pre">(3,</span> <span class="pre">2)]</span></code> as the argument, it should return <code class="docutils literal notranslate"><span class="pre">[(3,</span> <span class="pre">2),</span> <span class="pre">(6,</span> <span class="pre">1)]</span></code>.</p>
<p><em>Hint:</em> Treat separately the case when one of the terms is some constant <code class="docutils literal notranslate"><span class="pre">c</span></code>, i.e. it corresponds to a pair of the form <code class="docutils literal notranslate"><span class="pre">(c,0)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">polynomial_der</span><span class="p">(</span><span class="n">list_coeff</span><span class="p">):</span>
    <span class="n">derivative_list_coefficient</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">exponent</span> <span class="ow">in</span> <span class="n">list_coeff</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  
            <span class="n">derivative_list_coefficient</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coeff</span><span class="o">*</span><span class="n">exponent</span><span class="p">,</span> <span class="n">exponent</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">derivative_list_coefficient</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_func_close</span><span class="p">(</span><span class="n">newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">polynome</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])),</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="p">[</span><span class="n">polynome</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]])),</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">30</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mf">1.108531031360493</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.002329036436291343</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function seems to work&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to work
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="specific-examples">
<h2>Specific examples<a class="headerlink" href="#specific-examples" title="Permalink to this heading">#</a></h2>
<p>We will now apply the functions <code class="docutils literal notranslate"><span class="pre">newton_method</span></code>, <code class="docutils literal notranslate"><span class="pre">polynome</span></code> and <code class="docutils literal notranslate"><span class="pre">polynomial_der</span></code> to approximate the roots of several polynomial functions.</p>
<section id="todo-3-0-5-pt">
<h3>TODO 3 (0.5 pt)<a class="headerlink" href="#todo-3-0-5-pt" title="Permalink to this heading">#</a></h3>
<p>First apply the function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> with starting point <span class="math notranslate nohighlight">\(1\)</span> to the polynomial <span class="math notranslate nohighlight">\(x^2 - x -1\)</span>. Find an approximation of the root <span class="math notranslate nohighlight">\(\frac{1}{2} (1+\sqrt 5)\)</span>, also called the golden proportion, up to <span class="math notranslate nohighlight">\(9\)</span> significant digits. How many iterations do you need?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polynomial_coeffs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">polynomial_func</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_coeffs</span><span class="p">)</span>
<span class="n">polynomial_prime_coeffs</span> <span class="o">=</span> <span class="n">polynomial_der</span><span class="p">(</span><span class="n">polynomial_coeffs</span><span class="p">)</span>
<span class="n">polynomial_prime_func</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_prime_coeffs</span><span class="p">)</span>

<span class="n">start_punt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tolerantie</span> <span class="o">=</span> <span class="mf">1e-9</span> <span class="c1">#9 significante getallen</span>
<span class="n">maximum_iteraties</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">approx_root</span><span class="p">,</span> <span class="n">iteraties</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">polynomial_func</span><span class="p">,</span> <span class="n">polynomial_prime_func</span><span class="p">,</span> <span class="n">start_punt</span><span class="p">,</span> <span class="n">tolerantie</span><span class="p">,</span> <span class="n">maximum_iteraties</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De approximate root is </span><span class="si">{</span><span class="n">approx_root</span><span class="si">}</span><span class="s2"> and het kostte </span><span class="si">{</span><span class="n">iteraties</span><span class="si">}</span><span class="s2"> iteraties.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De approximate root is 1.618033988749989 and het kostte 6 iteraties.
</pre></div>
</div>
</div>
</div>
</section>
<section id="todo-4-0-25-pt">
<h3>TODO 4 (0.25 pt)<a class="headerlink" href="#todo-4-0-25-pt" title="Permalink to this heading">#</a></h3>
<p>Next, apply the function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> with starting point <span class="math notranslate nohighlight">\(1.5\)</span> to the polynomial <span class="math notranslate nohighlight">\(x^3 +x^2 -2\)</span>. Find an approximation of the root <span class="math notranslate nohighlight">\(1\)</span> up to <span class="math notranslate nohighlight">\(10\)</span> significant digits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polynomial_coeffs_2</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">polynomial_func_2</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_coeffs_2</span><span class="p">)</span>
<span class="n">polynomial_prime_coeffs_2</span> <span class="o">=</span> <span class="n">polynomial_der</span><span class="p">(</span><span class="n">polynomial_coeffs_2</span><span class="p">)</span>
<span class="n">polynomial_prime_func_2</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_prime_coeffs_2</span><span class="p">)</span>

<span class="n">start_punt_2</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">tolerantie_2</span> <span class="o">=</span> <span class="mf">1e-10</span>  
<span class="n">maximum_iteraties_2</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">approx_root_2</span><span class="p">,</span> <span class="n">iteraties_2</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">polynomial_func_2</span><span class="p">,</span> <span class="n">polynomial_prime_func_2</span><span class="p">,</span> <span class="n">start_punt_2</span><span class="p">,</span> <span class="n">tolerantie_2</span><span class="p">,</span> <span class="n">maximum_iteraties_2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De approximate root is </span><span class="si">{</span><span class="n">approx_root_2</span><span class="si">}</span><span class="s2"> en het kostte </span><span class="si">{</span><span class="n">iteraties_2</span><span class="si">}</span><span class="s2"> iteraties.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De approximate root is 1.0 en het kostte 6 iteraties.
</pre></div>
</div>
</div>
</div>
</section>
<section id="todo-5-0-25-pt">
<h3>TODO 5 (0.25 pt)<a class="headerlink" href="#todo-5-0-25-pt" title="Permalink to this heading">#</a></h3>
<p>What happens if your starting point is <span class="math notranslate nohighlight">\(-1.5\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_punt_3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
<span class="n">approx_root_3</span><span class="p">,</span> <span class="n">iteraties_3</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">polynomial_func_2</span><span class="p">,</span> <span class="n">polynomial_prime_func_2</span><span class="p">,</span> <span class="n">start_punt_3</span><span class="p">,</span> <span class="n">tolerantie_2</span><span class="p">,</span> <span class="n">maximum_iteraties_2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De approximate root is </span><span class="si">{</span><span class="n">approx_root_3</span><span class="si">}</span><span class="s2"> en het kostte </span><span class="si">{</span><span class="n">iteraties_3</span><span class="si">}</span><span class="s2"> iteraties.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De approximate root is False en het kostte 0 iteraties.
</pre></div>
</div>
</div>
</div>
</section>
<section id="todo-6-0-25-pt">
<h3>TODO 6 (0.25 pt)<a class="headerlink" href="#todo-6-0-25-pt" title="Permalink to this heading">#</a></h3>
<p>Finally apply the function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> with starting point <span class="math notranslate nohighlight">\(1.77\)</span> to the polynomial <span class="math notranslate nohighlight">\(x^3-3x^2 +2\)</span>. How many iterations do you need to find an approximation of the root with 10 significant digits?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polynomial_coeffs_3</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">polynomial_func_3</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_coeffs_3</span><span class="p">)</span>
<span class="n">polynomial_prime_coeffs_3</span> <span class="o">=</span> <span class="n">polynomial_der</span><span class="p">(</span><span class="n">polynomial_coeffs_3</span><span class="p">)</span>
<span class="n">polynomial_prime_func_3</span> <span class="o">=</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_prime_coeffs_3</span><span class="p">)</span>

<span class="n">start_punt_4</span> <span class="o">=</span> <span class="mf">1.77</span>
<span class="n">approx_root_4</span><span class="p">,</span> <span class="n">iteraties_4</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">polynomial_func_3</span><span class="p">,</span> <span class="n">polynomial_prime_func_3</span><span class="p">,</span> <span class="n">start_punt_4</span><span class="p">,</span> <span class="n">tolerantie_2</span><span class="p">,</span> <span class="n">maximum_iteraties_2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De approximate root is </span><span class="si">{</span><span class="n">approx_root_4</span><span class="si">}</span><span class="s2"> en het kostte </span><span class="si">{</span><span class="n">iteraties_4</span><span class="si">}</span><span class="s2"> iteraties.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De approximate root is 0.9999999999999999 en het kostte 7 iteraties.
</pre></div>
</div>
</div>
</div>
</section>
<section id="todo-7-0-25-pt">
<h3>TODO 7 (0.25 pt)<a class="headerlink" href="#todo-7-0-25-pt" title="Permalink to this heading">#</a></h3>
<p>What happens when the starting point is <span class="math notranslate nohighlight">\(1.78\)</span>? How many iterations do you need?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_punt_5</span> <span class="o">=</span> <span class="mf">1.78</span>
<span class="n">approx_root_5</span><span class="p">,</span> <span class="n">iteraties_5</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">polynomial_func_3</span><span class="p">,</span> <span class="n">polynomial_prime_func_3</span><span class="p">,</span> <span class="n">start_punt_5</span><span class="p">,</span> <span class="n">tolerantie_2</span><span class="p">,</span> <span class="n">maximum_iteraties_2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De approximate root is </span><span class="si">{</span><span class="n">approx_root_5</span><span class="si">}</span><span class="s2"> en het kostte </span><span class="si">{</span><span class="n">iteraties_5</span><span class="si">}</span><span class="s2"> iteraties.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De approximate root is 2.732050807568877 en het kostte 16 iteraties.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="relaxed-newton-method">
<h2>Relaxed Newton method<a class="headerlink" href="#relaxed-newton-method" title="Permalink to this heading">#</a></h2>
<p>We will see now how we can modify the Newton method in some cases where it does not converge. Consider the function</p>
<div class="math notranslate nohighlight">
\[ f(x) =  3x^5 -10 x^3 + 23 x \]</div>
<p>Note that
<span class="math notranslate nohighlight">\(f(x)= 0 \)</span> for <span class="math notranslate nohighlight">\(x=0\)</span>.
For some initial conditions, the Newton method does not work: take</p>
<div class="math notranslate nohighlight">
\[
N (x) = x - \frac{f(x)}{f'(x)} 
\]</div>
<p>and choose an initial point <span class="math notranslate nohighlight">\(x_0 =-1\)</span>. Then iterates of <span class="math notranslate nohighlight">\(N\)</span>
are periodic</p>
<div class="math notranslate nohighlight">
\[
-1 \to 1 \to -1 \to 1 \cdots
\]</div>
<p>Something similar happens for an initial point <span class="math notranslate nohighlight">\(x_0\)</span> near <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>Consider the  “relaxed Newton method” given by</p>
<div class="math notranslate nohighlight">
\[
N_\lambda (x) = x - \lambda \frac{f(x)}{f'(x)}.
\]</div>
<p>Now we choose <span class="math notranslate nohighlight">\(\lambda\)</span> random from the interval <span class="math notranslate nohighlight">\([1-R,1+R]\)</span> (uniform distribution) with an <span class="math notranslate nohighlight">\(R\)</span>  satisfying <span class="math notranslate nohighlight">\(\frac{1}{2}\le R &lt;1\)</span>.
That means, we iterate as follows (“random relaxed Newton method”):</p>
<ul class="simple">
<li><p>take an initial point <span class="math notranslate nohighlight">\(x_0\)</span>;</p></li>
<li><p>choose <span class="math notranslate nohighlight">\(\lambda\)</span> random (say <span class="math notranslate nohighlight">\(\lambda_0\)</span>);</p></li>
<li><p>apply <span class="math notranslate nohighlight">\(N_{\lambda_0}\)</span>, i.e. calculate <span class="math notranslate nohighlight">\(x_1 = N_{\lambda_0} (x_0)\)</span>;</p></li>
<li><p>choose again  <span class="math notranslate nohighlight">\(\lambda\)</span> random (this gives <span class="math notranslate nohighlight">\(\lambda_1\)</span>);</p></li>
<li><p>apply <span class="math notranslate nohighlight">\(N_{\lambda_1}\)</span>: <span class="math notranslate nohighlight">\(x_2 = N_{\lambda_1} (x_1)\)</span>;</p></li>
<li><p>etcetera.</p></li>
</ul>
<p>Iterates converge to the solution <span class="math notranslate nohighlight">\(0\)</span>.</p>
<section id="todo-8-1-pt">
<h3>TODO 8 (1 pt)<a class="headerlink" href="#todo-8-1-pt" title="Permalink to this heading">#</a></h3>
<p>Write code to do this.
Can you explain (non-rigorously) why this works?</p>
<p>You can use the function <code class="docutils literal notranslate"><span class="pre">uniform</span></code> from the <code class="docutils literal notranslate"><span class="pre">random</span></code> library to generate a random number between <span class="math notranslate nohighlight">\((1-R)\)</span> and <span class="math notranslate nohighlight">\((1+R)\)</span>. The full documentation can be found <a class="reference external" href="https://docs.python.org/3/library/random.html#random.uniform">here</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">relaxed_newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_coeff_4</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">test_func_close</span><span class="p">(</span><span class="n">relaxed_newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">polynome</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0007000012677832279</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>
<span class="n">test_func_close</span><span class="p">(</span><span class="n">relaxed_newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">polynome</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0006011773865865731</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span> 
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Function seems to work&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">list_coeff_4</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">test_func_close</span><span class="p">(</span><span class="n">relaxed_newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">polynome</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0007000012677832279</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">test_func_close</span><span class="p">(</span><span class="n">relaxed_newton_method</span><span class="p">,</span> <span class="p">[[</span><span class="n">polynome</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">(</span><span class="n">list_coeff_4</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]],</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.0006011773865865731</span><span class="p">,</span> <span class="mi">10</span><span class="p">)])</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

<span class="nn">Cell In[2], line 5,</span> in <span class="ni">test_func_close</span><span class="nt">(func, arg_list, ret_list, index_list)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_list</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">5</span>     <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s2">&quot;Basic test failed&quot;</span>

<span class="ne">TypeError</span>: &#39;NoneType&#39; object is not subscriptable
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plotting-histograms-for-the-newton-method">
<h2>Plotting histograms for the Newton method<a class="headerlink" href="#plotting-histograms-for-the-newton-method" title="Permalink to this heading">#</a></h2>
<p>We will now try to see to which extent the number of iterations depends on the starting point. We will consider a large enough sample of starting points <span class="math notranslate nohighlight">\(x\)</span>, equally distributed over some interval <span class="math notranslate nohighlight">\(I\)</span>. We will then plot an histogram where each bin corresponds to an <span class="math notranslate nohighlight">\(x\)</span> and the height represents the number of iterations needed to converge when the starting point of the Newton method is <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>So we start by giving an example on how to plot a simple histogram. Full documentation can be found <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.hist.html">here</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_hist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">sequence_bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sequence_bins</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">list_hist</span><span class="p">,</span> <span class="n">sequence_bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5, 7, 9, 11, 13]
</pre></div>
</div>
<img alt="../_images/8da5b580e460dcdec4f0785dd961a73f78f9d79c83d5f7aea7d28dd26e1b31f4.png" src="../_images/8da5b580e460dcdec4f0785dd961a73f78f9d79c83d5f7aea7d28dd26e1b31f4.png" />
</div>
</div>
<p>In the example, <code class="docutils literal notranslate"><span class="pre">sequence_bins</span></code> is equal to the set <span class="math notranslate nohighlight">\(\{ 5, 7, 9, 11, 13 \}\)</span>. When passed as a second argument in the <code class="docutils literal notranslate"><span class="pre">hist</span></code> function from the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library, this ensures that the following bins will be created</p>
<div class="math notranslate nohighlight">
\[
[5, 7), [7, 9), [9, 11), [11, 13)
\]</div>
<p>where <span class="math notranslate nohighlight">\([5, 7)\)</span> means that this is a half-open interval, where <span class="math notranslate nohighlight">\(5\)</span> is included in the bin, and <span class="math notranslate nohighlight">\(7\)</span> is not.</p>
<p>Once the bins are created, we can see in <code class="docutils literal notranslate"><span class="pre">list_hist</span></code> that there are <span class="math notranslate nohighlight">\(3\)</span> values that belong to the interval <span class="math notranslate nohighlight">\([5,7)\)</span> (namely <span class="math notranslate nohighlight">\(6, 6.5\)</span> and <span class="math notranslate nohighlight">\(6.8\)</span>) and the height of the histogram for that bin is <span class="math notranslate nohighlight">\(3\)</span>.</p>
<section id="todo-9-2-5-pt">
<h3>TODO 9 (2.5 pt)<a class="headerlink" href="#todo-9-2-5-pt" title="Permalink to this heading">#</a></h3>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">hist_number_it(f,</span> <span class="pre">f_prime,</span> <span class="pre">n,</span> <span class="pre">int_min,</span> <span class="pre">int_max,</span> <span class="pre">tol,</span> <span class="pre">max_it)</span></code> where <code class="docutils literal notranslate"><span class="pre">f</span></code> is a function, <code class="docutils literal notranslate"><span class="pre">f'</span></code> is its derivative, <code class="docutils literal notranslate"><span class="pre">tol</span></code> is the tolerance and <code class="docutils literal notranslate"><span class="pre">max_it</span></code> is the maximum number of iterations of the Newton method (so this is all the same as in the very first function of this assignment).</p>
<p>Then <code class="docutils literal notranslate"><span class="pre">hist_number_it</span></code> should plot an histogram over the interval <code class="docutils literal notranslate"><span class="pre">[int_min,</span> <span class="pre">int_max]</span></code> with <code class="docutils literal notranslate"><span class="pre">n</span></code> bins of equal size. The height of the column of the <span class="math notranslate nohighlight">\(i^{th} \)</span> bin should be the number of iterations needed to converge, as outputed by <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> when the starting point <code class="docutils literal notranslate"><span class="pre">s_i</span></code> is</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>s_i = int_min + i * (int_max - int_min) / n
</pre></div>
</div>
<p>So basically we take a sample of <code class="docutils literal notranslate"><span class="pre">n</span></code> points over the interval <code class="docutils literal notranslate"><span class="pre">[int_min,</span> <span class="pre">int_max]</span></code> and each of these points corresponds to a bin of the histogram. The height of the bin corresponds to the number of iterations of the Newton method.</p>
<p>The function should also plot the graph of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> over the interval <code class="docutils literal notranslate"><span class="pre">[int_min,</span> <span class="pre">int_max]</span></code>. So the final result should be a plot of the graph of the original function, with a histogram overlayed, showing the number of iterations at each point. What points do you expect will need more steps to converge and what points will need less steps?</p>
</section>
<section id="some-hints-for-the-function">
<h3>Some hints for the function<a class="headerlink" href="#some-hints-for-the-function" title="Permalink to this heading">#</a></h3>
<p>If you want to make <span class="math notranslate nohighlight">\(n\)</span> bins, with <span class="math notranslate nohighlight">\(n\)</span> different starting points, then your <code class="docutils literal notranslate"><span class="pre">sequence_bins</span></code> should define <span class="math notranslate nohighlight">\(n+1\)</span> bounds, resulting in <span class="math notranslate nohighlight">\(n\)</span> intervals. Create your list of <span class="math notranslate nohighlight">\(n\)</span> starting points <code class="docutils literal notranslate"><span class="pre">s_i</span></code> first, and then create the list containing <span class="math notranslate nohighlight">\(n+1\)</span> bounds, remembering that the first bound of the half-open interval <em>is</em> included in the interval itself.</p>
<p>Also, in order to make single bar in a histogram of height <span class="math notranslate nohighlight">\(h\)</span>, located at <span class="math notranslate nohighlight">\([x, x+d)\)</span>, the easiest way would be to just include <span class="math notranslate nohighlight">\(h\)</span> copies of the value of <span class="math notranslate nohighlight">\(x\)</span> in the list of values used to make the histogram. That way, you are certain there are exactly <span class="math notranslate nohighlight">\(h\)</span> values that fall within the interval <span class="math notranslate nohighlight">\([x, x+d)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hist_number_it</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">int_min</span><span class="p">,</span> <span class="n">int_max</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">int_min</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">int_max</span> <span class="o">-</span> <span class="n">int_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    
    <span class="n">iterations</span> <span class="o">=</span> <span class="p">[</span><span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start_points</span><span class="p">]</span>
    
    <span class="n">sequence_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">int_min</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">int_max</span> <span class="o">-</span> <span class="n">int_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    
    <span class="n">hist_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hist_values</span><span class="p">,</span> <span class="n">sequence_bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;iteraties&#39;</span><span class="p">)</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">int_min</span><span class="p">,</span> <span class="n">int_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">list_coeff_3</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span> 
<span class="n">hist_number_it</span><span class="p">(</span><span class="n">polynome</span><span class="p">(</span><span class="n">list_coeff_3</span><span class="p">),</span> <span class="n">polynome</span><span class="p">(</span><span class="n">polynomial_der</span><span class="p">(</span><span class="n">list_coeff_3</span><span class="p">)),</span> <span class="mi">2000</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/164e699ab50059a26d276a3adc4f64379db2ca4dcc0cf6aa5d0f4bbcc254da0b.png" src="../_images/164e699ab50059a26d276a3adc4f64379db2ca4dcc0cf6aa5d0f4bbcc254da0b.png" />
</div>
</div>
</section>
</section>
<section id="plotting-histograms-while-differentiating-each-root">
<h2>Plotting histograms while differentiating each root<a class="headerlink" href="#plotting-histograms-while-differentiating-each-root" title="Permalink to this heading">#</a></h2>
<p>We will now do the same thing but for a different function <code class="docutils literal notranslate"><span class="pre">func_1</span></code> (defined below) with <span class="math notranslate nohighlight">\(3\)</span> roots. In addition, instead of 1 histogram, we will plot 3 histograms, each of them of a different color and each corresponding to one of the <span class="math notranslate nohighlight">\(3\)</span> roots.</p>
<p>If a starting point <span class="math notranslate nohighlight">\(x\)</span> is associated with a a bin of height <span class="math notranslate nohighlight">\(h\)</span>, the color of the bin indicates to which root the Newton method would converge (if the starting point is <span class="math notranslate nohighlight">\(x\)</span>) and the height indicates as before the number of iterations. So basically, we have to do the same thing as in the previous exercises except that we have to make <span class="math notranslate nohighlight">\(3\)</span> lists instead of one (because we need to plot <span class="math notranslate nohighlight">\(3\)</span> histograms).</p>
<p>We want to put in the same list the points <span class="math notranslate nohighlight">\(x\)</span> that converge to the same root.</p>
<section id="todo-10-1-pt">
<h3>TODO 10 (1 pt)<a class="headerlink" href="#todo-10-1-pt" title="Permalink to this heading">#</a></h3>
<p>To help you achieve that, we ask you to first write a function <code class="docutils literal notranslate"><span class="pre">same_root(f,</span> <span class="pre">f_prime,</span> <span class="pre">x1,</span> <span class="pre">x2,</span> <span class="pre">epsilon,</span> <span class="pre">tol,</span> <span class="pre">max_it)</span></code> that returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">x_1</span></code> and <code class="docutils literal notranslate"><span class="pre">x_2</span></code> converge to the same root. More precisely, if the approximations of the roots with starting points <code class="docutils literal notranslate"><span class="pre">x_1</span></code> and <code class="docutils literal notranslate"><span class="pre">x_2</span></code> differ of at most <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>.</p>
</section>
<section id="todo-11-2-pt">
<h3>TODO 11 (2 pt)<a class="headerlink" href="#todo-11-2-pt" title="Permalink to this heading">#</a></h3>
<p>Then using that function, write a function <code class="docutils literal notranslate"><span class="pre">plot_hist_newton(f,</span> <span class="pre">f_prime,</span> <span class="pre">n,</span> <span class="pre">int_min,</span> <span class="pre">int_max,</span> <span class="pre">epsilon,</span> <span class="pre">tol,</span> <span class="pre">max_it)</span></code> that when the input is the function <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">func_1</span></code> and <code class="docutils literal notranslate"><span class="pre">f_prime</span> <span class="pre">=</span> <span class="pre">func_1_der</span></code> (<code class="docutils literal notranslate"><span class="pre">func_1</span></code> and <code class="docutils literal notranslate"><span class="pre">func_1_der</span></code> both defined in the code below), plot the graph of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> over the interval <code class="docutils literal notranslate"><span class="pre">[int_min,</span> <span class="pre">int_max]</span></code> and <span class="math notranslate nohighlight">\(3\)</span> histograms, each of them corresponding to one of the <span class="math notranslate nohighlight">\(3\)</span> roots. As before, <code class="docutils literal notranslate"><span class="pre">tol</span></code> is the tolerance and <code class="docutils literal notranslate"><span class="pre">max_it</span></code> is the maximum number of iterations. <code class="docutils literal notranslate"><span class="pre">epsilon</span></code> is one of the inputs of the function <code class="docutils literal notranslate"><span class="pre">same_root</span></code> that you should use to write your function <code class="docutils literal notranslate"><span class="pre">plot_hist_newton</span></code>.</p>
<p>The 3 histograms corresponding to each root <span class="math notranslate nohighlight">\(r\)</span> all have <code class="docutils literal notranslate"><span class="pre">n</span></code> bins (like in the previous exercise) and each bin number <span class="math notranslate nohighlight">\(i\)</span> corresponds to the starting point</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>s_i = int_min + i * (int_max - int_min) / n
</pre></div>
</div>
<p>In each of these histograms, only the starting points that converge to the root <span class="math notranslate nohighlight">\(r\)</span> of that histogram, have their number of iterations counted in that bin. All other bins have no values counted in them, i.e. a height of <span class="math notranslate nohighlight">\(0\)</span>. The height of the non-empty bins should correspond to the number of iterations of the Newton method with starting point <span class="math notranslate nohighlight">\(x\)</span>, as before. Plotting these 3 histograms in the same plot should overlay them and make each of the different colors show up “side by side”, as the other bins contain no values.</p>
<p><em>Hint:</em> When you compute a root for some starting point <span class="math notranslate nohighlight">\(x\)</span>, consider if it should be included in one of the existing histogram lists, or if this is a <em>new</em> root you have not seen before, meaning you have to use a new empty list to store the number of iterations. Use your function <code class="docutils literal notranslate"><span class="pre">same_root</span></code> to distinguish these cases carefully and write code to handle them separately.</p>
<p>To make your code as general as possible, do not use the values of the roots in your function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func_1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func_1_der</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>

<span class="k">def</span> <span class="nf">same_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
    <span class="n">root1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">)</span>
    <span class="n">root2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">root1</span> <span class="o">-</span> <span class="n">root2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">same_root</span><span class="p">(</span><span class="n">func_0_closure</span><span class="p">,</span> <span class="n">func_0_der_closure</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">same_root</span><span class="p">(</span><span class="n">func_0_closure</span><span class="p">,</span> <span class="n">func_0_der_closure</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">same_root</span><span class="p">(</span><span class="n">func_0_closure</span><span class="p">,</span> <span class="n">func_0_der_closure</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">same_root</span><span class="p">(</span><span class="n">func_0_closure</span><span class="p">,</span> <span class="n">func_0_der_closure</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Basic test failed&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function seems to work&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to work
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hist_newton</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">int_min</span><span class="p">,</span> <span class="n">int_max</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">int_min</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">int_max</span> <span class="o">-</span> <span class="n">int_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    
    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iters_per_root</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start_points_per_root</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">start_points</span><span class="p">:</span>
        <span class="n">root</span><span class="p">,</span> <span class="n">iters</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">)</span>
        
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">known_root</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">roots</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">same_root</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">known_root</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
                <span class="n">iters_per_root</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iters</span><span class="p">)</span>
                <span class="n">start_points_per_root</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
            <span class="n">iters_per_root</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">iters</span><span class="p">])</span>
            <span class="n">start_points_per_root</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">s</span><span class="p">])</span>
    
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">]</span>
    <span class="n">sequence_bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">int_min</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">int_max</span> <span class="o">-</span> <span class="n">int_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iters</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iters_per_root</span><span class="p">):</span>
        <span class="n">hist_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_points_per_root</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">iters</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iters</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">hist_values</span><span class="p">,</span> <span class="n">sequence_bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">int_min</span><span class="p">,</span> <span class="n">int_max</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_hist_newton</span><span class="p">(</span><span class="n">func_1</span><span class="p">,</span> <span class="n">func_1_der</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        
        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0c94875950641d05395112c365ebc59a45d678662ec3df5877a763cef08ac77e.png" src="../_images/0c94875950641d05395112c365ebc59a45d678662ec3df5877a763cef08ac77e.png" />
</div>
</div>
</section>
</section>
<section id="newton-method-in-2-dimensions">
<h2>Newton method in 2 dimensions<a class="headerlink" href="#newton-method-in-2-dimensions" title="Permalink to this heading">#</a></h2>
<p>We will now implement the Newton method in the case of a function with <span class="math notranslate nohighlight">\(2\)</span> variables. Let <span class="math notranslate nohighlight">\(f\)</span> be function from <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[
f(x,y) = (f_x(x,y), f_y(x,y))
\]</div>
<p>where <span class="math notranslate nohighlight">\(f_x(x,y) = x^3 - 3xy^2 - x^2 + y^2 + x-1\)</span> and <span class="math notranslate nohighlight">\(f_y(x,y) = 3x^2y - y^3 -2xy +y\)</span>.</p>
<p>Its roots are the points <span class="math notranslate nohighlight">\((x,y)\)</span> such that <span class="math notranslate nohighlight">\(f(x,y) = (0,0)\)</span>. To find approximations of the roots, we can generalize the Newton method that we used previously. Our starting point is any point <span class="math notranslate nohighlight">\((x_0, y_0)\)</span> and we iteratively compute approximations <span class="math notranslate nohighlight">\((x_0, y_0), \dots, (x_k,y_k)\)</span> of the roots using the following rule: If <span class="math notranslate nohighlight">\(x(_i,y_i)\)</span> is the approximation of the root at the <span class="math notranslate nohighlight">\(i\)</span>-th iteration, then <span class="math notranslate nohighlight">\((x_{i+1}, y_{i+1})\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
(x_{i+1}, y_{i+1}) = (x_i,y_i) - [Df(x_i,y_i)]^{-1} f(x_i, y_i).
\]</div>
<p>where <span class="math notranslate nohighlight">\(Df(x_i,y_i)\)</span> is the Jacobian matrix evaluated at the point <span class="math notranslate nohighlight">\((x_i, y_i)\)</span>. For a function from <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>, the Jacobian matrix <span class="math notranslate nohighlight">\(Df(x,y)\)</span>  is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
\frac{\partial f_x (x,y)}{\partial x} &amp; \frac{\partial f_x(x,y)}{\partial y}\\
\frac{\partial f_y(x,y)}{\partial x} &amp; \frac{\partial f_y(x,y)}{\partial y}\\
\end{bmatrix}
\end{split}\]</div>
<p>In our specific case, <span class="math notranslate nohighlight">\(f\)</span> has <span class="math notranslate nohighlight">\(3\)</span> roots: <span class="math notranslate nohighlight">\((1,0)\)</span>, <span class="math notranslate nohighlight">\((0,1)\)</span> and <span class="math notranslate nohighlight">\((0,-1)\)</span>. Given a starting point <span class="math notranslate nohighlight">\((x,y)\)</span>, the Newton method may converge to one of those <span class="math notranslate nohighlight">\(3\)</span> roots. We will color the 2D plane with 3 different colors in such a way that if <span class="math notranslate nohighlight">\(2\)</span> points converge to the same root, they have the same color and if <span class="math notranslate nohighlight">\(2\)</span> points converge to different roots, they are assigned different colors.</p>
<p>This means that the resulting image will have pixels, each corresponding to an <span class="math notranslate nohighlight">\((x,y)\)</span> coordinate in the the plane, and the color of that pixel will depend on the root to which <span class="math notranslate nohighlight">\((x,y)\)</span> converges. Note that this is very similar to what you just did for the histograms (colors also indicated the different roots), but now it is plotted in 2 dimensions as an image. The code to compare the different returned roots and to color the image has already been provided.</p>
<p>You still have to write <span class="math notranslate nohighlight">\(3\)</span> functions to create the image</p>
<section id="todo-12-3-pts">
<h3>TODO 12 (3 pts)<a class="headerlink" href="#todo-12-3-pts" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>(1 pt) the function <code class="docutils literal notranslate"><span class="pre">func_2d</span></code> which takes as an input a vector <span class="math notranslate nohighlight">\([x,y]^T\)</span> and returns the vector <span class="math notranslate nohighlight">\([f_x(x,y), f_y(x,y)]^T\)</span></p></li>
<li><p>(1 pt) the function <code class="docutils literal notranslate"><span class="pre">func_2d_der</span></code> which takes as an input a vector <span class="math notranslate nohighlight">\([x,y]^T\)</span> and returns the matrix <span class="math notranslate nohighlight">\(Df(x,y)\)</span></p></li>
<li><p>(1 pt) the function <code class="docutils literal notranslate"><span class="pre">method_newton_2d(f,</span> <span class="pre">f_der,</span> <span class="pre">x_0,</span> <span class="pre">y_0,</span> <span class="pre">tol,</span> <span class="pre">max_it)</span></code> which returns the approximation of the root using the Newton method and starting point <span class="math notranslate nohighlight">\((\)</span> <code class="docutils literal notranslate"><span class="pre">x_0</span></code>, <code class="docutils literal notranslate"><span class="pre">y_0</span></code> <span class="math notranslate nohighlight">\()\)</span>. Here, <code class="docutils literal notranslate"><span class="pre">f</span></code> is a function which maps a vector of dimension <span class="math notranslate nohighlight">\(2\)</span> to a vector of dimension <span class="math notranslate nohighlight">\(2\)</span>. <code class="docutils literal notranslate"><span class="pre">f_der</span></code> is the jacobian matrix of <code class="docutils literal notranslate"><span class="pre">f</span></code>. As usual, <code class="docutils literal notranslate"><span class="pre">tol</span></code> is the tolerance and <code class="docutils literal notranslate"><span class="pre">max_it</span></code> is the maximum number of iteration (so we stop at <span class="math notranslate nohighlight">\((x_k,y_k)\)</span> either because <span class="math notranslate nohighlight">\(k&gt;\)</span> <code class="docutils literal notranslate"><span class="pre">max_it</span></code> or the distance between <span class="math notranslate nohighlight">\((x_k,y_k)\)</span> and <span class="math notranslate nohighlight">\((x_{k+1},y_{k+1})\)</span> is <span class="math notranslate nohighlight">\(&lt;\)</span> <code class="docutils literal notranslate"><span class="pre">tol</span></code>). Hint. To find the distance between 2 vectors, you can use the function <code class="docutils literal notranslate"><span class="pre">np.linalg.norm</span></code> (full documentation <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.norm.html">here</a>).</p></li>
</ul>
<p>So these <span class="math notranslate nohighlight">\(3\)</span> functions output a vector of dimension <span class="math notranslate nohighlight">\(2\)</span> or a matrix. How do we represent a matrix in numpy? For example, the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6 
\end{bmatrix}
\end{split}\]</div>
<p>can be represented by the numpy array</p>
<p><code class="docutils literal notranslate"><span class="pre">np.array([[1,2,3],</span> <span class="pre">[4,5,6]])</span></code></p>
<p>and the vector <span class="math notranslate nohighlight">\([x,y]^T\)</span> can be represented by the numpy array</p>
<p><code class="docutils literal notranslate"><span class="pre">vec</span> <span class="pre">=</span> <span class="pre">np.array([[x],[y]])</span></code></p>
<p>Once matrices and vectors are represented as numpy arrays, the advantage is that there are many built-in functions from the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library to can be used to manipulate those arrays. Here, you may find useful the function <code class="docutils literal notranslate"><span class="pre">np.linalg.inv</span></code> which computes the inverse of a matrix and the function <code class="docutils literal notranslate"><span class="pre">np.dot</span></code> which computes the product of <span class="math notranslate nohighlight">\(2\)</span> matrices.</p>
<p>Pay attention to the fact that the outputs of your functions should be also numpy arrays (and not lists).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func_2d</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">fy</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">fx</span><span class="p">],[</span><span class="n">fy</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">40</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func_2d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">48</span><span class="p">],[</span><span class="mi">124</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function seems to work&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to work
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func_2d_der</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dfx_dx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">dfx_dy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dfy_dx</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dfy_dy</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">dfx_dx</span><span class="p">,</span> <span class="n">dfx_dy</span><span class="p">],[</span><span class="n">dfy_dx</span><span class="p">,</span> <span class="n">dfy_dy</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func_2d_der</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">],[</span><span class="mi">30</span><span class="p">,</span><span class="o">-</span><span class="mi">18</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func_2d_der</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">54</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">],[</span><span class="mi">56</span><span class="p">,</span><span class="mi">54</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function seems to work&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to work
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newton_method_2d</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_der</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">):</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x_0</span><span class="p">],[</span><span class="n">y_0</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_it</span><span class="p">):</span>
        <span class="n">vec_new</span> <span class="o">=</span> <span class="n">vec</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">f_der</span><span class="p">(</span><span class="n">vec</span><span class="p">)),</span> <span class="n">f</span><span class="p">(</span><span class="n">vec</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vec_new</span> <span class="o">-</span> <span class="n">vec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">vec_new</span>
    <span class="k">return</span> <span class="n">vec</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">newton_method_2d</span><span class="p">(</span><span class="n">func_2d</span><span class="p">,</span> <span class="n">func_2d_der</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.03571238</span><span class="p">],[</span><span class="mf">1.00455638</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">newton_method_2d</span><span class="p">(</span><span class="n">func_2d</span><span class="p">,</span> <span class="n">func_2d_der</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.98553187</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.03361085</span><span class="p">]])),</span> <span class="s1">&#39;Basic test failed&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function seems to work&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Function seems to work
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_der</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">,</span> <span class="n">sol_1</span><span class="p">,</span> <span class="n">sol_2</span><span class="p">,</span> <span class="n">sol_3</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="n">resol</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">resol</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span><span class="p">,</span> <span class="n">resol</span><span class="p">)</span>
    
    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">resol</span><span class="p">,</span> <span class="n">resol</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">sol_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol_2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sol_3</span><span class="p">)])</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
            <span class="n">approx</span> <span class="o">=</span> <span class="n">newton_method_2d</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f_der</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span> <span class="n">max_it</span><span class="p">)</span>
            <span class="n">norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sol_mat</span> <span class="o">-</span> <span class="n">approx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">image</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">norms</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">sol_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">sol_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="c1"># Once your program is correct, you can increase the resolution</span>
<span class="c1"># (this will increase the running time)</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="mi">350</span>

<span class="n">plot_image</span><span class="p">(</span><span class="n">func_2d</span><span class="p">,</span> <span class="n">func_2d_der</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="n">sol_1</span><span class="p">,</span> <span class="n">sol_2</span><span class="p">,</span> <span class="n">sol_3</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c957b473d2e740da8b43a276d2292c41a3aa493b16a5ea44399d9d045a930e88.png" src="../_images/c957b473d2e740da8b43a276d2292c41a3aa493b16a5ea44399d9d045a930e88.png" />
</div>
</div>
</section>
</section>
<section id="application-finding-the-angle-for-a-projectile-bonus-0-5-pt">
<h2>Application: finding the angle for a projectile (bonus 0.5 pt)<a class="headerlink" href="#application-finding-the-angle-for-a-projectile-bonus-0-5-pt" title="Permalink to this heading">#</a></h2>
<p>A projectile is shot with a speed <span class="math notranslate nohighlight">\(v\)</span> and an angle <span class="math notranslate nohighlight">\(\theta\)</span>. The height of the projectile at a distance <span class="math notranslate nohighlight">\(x\)</span> from the origin is given by the function
$<span class="math notranslate nohighlight">\(
f(x, \theta) = \tan \theta x - \frac{1}{2} g \left( \frac{x}{v \cos \theta} \right)^2
\)</span><span class="math notranslate nohighlight">\(
where \)</span>g=9.8 m/s^2$</p>
<p>We would like to know at which angle we need to shoot so that the projectile hit the ground at a fixed distance <span class="math notranslate nohighlight">\(R\)</span>. This means that we have to find the right angle <span class="math notranslate nohighlight">\(\theta\)</span> such that <span class="math notranslate nohighlight">\(f(R,\theta) =0\)</span> (the height of the projectile at distance <span class="math notranslate nohighlight">\(R\)</span> should be <span class="math notranslate nohighlight">\(0\)</span>).</p>
<p>Since <span class="math notranslate nohighlight">\(x\)</span> is now some fixed distance <span class="math notranslate nohighlight">\(R\)</span>, we have a function <span class="math notranslate nohighlight">\(h\)</span> with only one variable.</p>
<div class="math notranslate nohighlight">
\[
h(\theta) = \tan (\theta) R - \frac{1}{2} g \left( \frac{R}{v \cos (\theta)} \right)^2
\]</div>
<p>Our goal is then to determine <span class="math notranslate nohighlight">\(\theta\)</span> such that <span class="math notranslate nohighlight">\(h(\theta) =0\)</span>.</p>
<p>Given <span class="math notranslate nohighlight">\(R=10 m\)</span> and <span class="math notranslate nohighlight">\(v = 13 m/s\)</span>, use your function <code class="docutils literal notranslate"><span class="pre">newton_method</span></code> to find the right angle such that projectile hit the ground after exactly <span class="math notranslate nohighlight">\(10 m\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">v</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.8</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">R</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">R</span> <span class="o">/</span> <span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">h_der</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">g</span> <span class="o">*</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">theta_0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>  <span class="c1"># 45 graden</span>

<span class="n">theta</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">h_der</span><span class="p">,</span> <span class="n">theta_0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_it</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>


<span class="n">theta_degrees</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="c1"># naar graden omzetten</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;De correcte hoek is </span><span class="si">{</span><span class="n">theta_degrees</span><span class="si">}</span><span class="s2"> graden.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>De correcte hoek is 17.721144927198875 graden.
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-of-newton-raphson-method">Implementation of Newton-Raphson method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-1-2-5-pt">TODO 1 (2.5 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closure-of-polynomial-functions">Closure of Polynomial Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivate-function">Derivate function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-2-1-pt">TODO 2 (1 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-examples">Specific examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-3-0-5-pt">TODO 3 (0.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-4-0-25-pt">TODO 4 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-5-0-25-pt">TODO 5 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-6-0-25-pt">TODO 6 (0.25 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-7-0-25-pt">TODO 7 (0.25 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxed-newton-method">Relaxed Newton method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-8-1-pt">TODO 8 (1 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-histograms-for-the-newton-method">Plotting histograms for the Newton method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-9-2-5-pt">TODO 9 (2.5 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-hints-for-the-function">Some hints for the function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-histograms-while-differentiating-each-root">Plotting histograms while differentiating each root</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-10-1-pt">TODO 10 (1 pt)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-11-2-pt">TODO 11 (2 pt)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-method-in-2-dimensions">Newton method in 2 dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#todo-12-3-pts">TODO 12 (3 pts)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-finding-the-angle-for-a-projectile-bonus-0-5-pt">Application: finding the angle for a projectile (bonus 0.5 pt)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yen-Chia Hsu
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>